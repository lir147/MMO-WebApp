<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>MMO RPG WebApp</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body { font-family: Arial; margin:0; padding:0; background:#1e1e1e; color:white; }
    .game { text-align:center; padding:15px; }
    img { border-radius:8px; }
    button { margin:5px; padding:8px 12px; border:none; border-radius:6px; background:#4CAF50; color:white; font-size:14px; }
    button:hover { background:#45a049; cursor:pointer; }
    .panel { margin-top:15px; background:#2e2e2e; padding:10px; border-radius:10px; text-align:left; }
    .inv-item { display:flex; align-items:center; margin:4px 0; cursor:pointer; }
    .inv-item img { width:40px; height:40px; margin-right:8px; }
    .rarity-common { color: #bbb; }
    .rarity-rare { color: #4aa3ff; }
    .rarity-epic { color: #b84aff; }
    .rarity-legendary { color: #ffcc00; font-weight:bold; }
    #log { margin-top:10px; min-height:30px; }
  </style>
</head>
<body>
  <div class="game">
    <h1>ğŸŒ ĞšĞ°Ñ€Ñ‚Ğ°</h1>
    <img src="https://i.ibb.co/6Wfj2M5/fantasy-map.jpg" width="95%">

    <h2>ğŸ§™ ĞŸĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶: <span id="character">Ğ’Ğ¾Ğ¸Ğ½</span></h2>
    <p>Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ: <span id="level">1</span> | ĞĞ¿Ñ‹Ñ‚: <span id="exp">0</span>/100 | ĞÑ‡ĞºĞ¸ Ğ½Ğ°Ğ²Ñ‹ĞºĞ¾Ğ²: <span id="skill-points">0</span></p>

    <img id="player-img" src="https://i.ibb.co/RzVztcT/warrior.png" width="120">

    <div>
      <button onclick="attack()">âš”ï¸ ĞÑ‚Ğ°ĞºĞ¾Ğ²Ğ°Ñ‚ÑŒ</button>
      <button onclick="showInventory()">ğŸ’ Ğ˜Ğ½Ğ²ĞµĞ½Ñ‚Ğ°Ñ€ÑŒ</button>
      <button onclick="showEquipment()">ğŸ›¡ï¸ Ğ­ĞºĞ¸Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°</button>
      <button onclick="showStats()">ğŸ“Š Ğ¥Ğ°Ñ€Ğ°ĞºÑ‚ĞµÑ€Ğ¸ÑÑ‚Ğ¸ĞºĞ¸</button>
      <button onclick="showSkills()">ğŸŒŸ ĞĞ°Ğ²Ñ‹ĞºĞ¸</button>
    </div>

    <div id="log"></div>

    <!-- Ğ˜Ğ½Ğ²ĞµĞ½Ñ‚Ğ°Ñ€ÑŒ -->
    <div class="panel" id="inventory" style="display:none;">
      <h3>ğŸ’ Ğ˜Ğ½Ğ²ĞµĞ½Ñ‚Ğ°Ñ€ÑŒ</h3>
      <ul id="items"></ul>
    </div>

    <!-- Ğ­ĞºĞ¸Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° -->
    <div class="panel" id="equipment" style="display:none;">
      <h3>ğŸ›¡ï¸ Ğ­ĞºĞ¸Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°</h3>
      <p>ĞÑ€ÑƒĞ¶Ğ¸Ğµ: <span id="slot-weapon">-</span></p>
      <p>Ğ‘Ñ€Ğ¾Ğ½Ñ: <span id="slot-armor">-</span></p>
      <p>ĞĞºÑĞµÑÑÑƒĞ°Ñ€: <span id="slot-accessory">-</span></p>
    </div>

    <!-- Ğ¥Ğ°Ñ€Ğ°ĞºÑ‚ĞµÑ€Ğ¸ÑÑ‚Ğ¸ĞºĞ¸ -->
    <div class="panel" id="stats" style="display:none;">
      <h3>ğŸ“Š Ğ¥Ğ°Ñ€Ğ°ĞºÑ‚ĞµÑ€Ğ¸ÑÑ‚Ğ¸ĞºĞ¸</h3>
      <p>â¤ï¸ HP: <span id="stat-hp">100</span></p>
      <p>ğŸ”® MP: <span id="stat-mp">50</span></p>
      <p>âš”ï¸ Ğ¡Ğ¸Ğ»Ğ°: <span id="stat-str">10</span></p>
      <p>ğŸ›¡ï¸ Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ°: <span id="stat-def">5</span></p>
      <p>ğŸ“– Ğ˜Ğ½Ñ‚ĞµĞ»Ğ»ĞµĞºÑ‚: <span id="stat-int">5</span></p>
      <p>ğŸ¹ Ğ›Ğ¾Ğ²ĞºĞ¾ÑÑ‚ÑŒ: <span id="stat-agi">5</span></p>
    </div>

    <!-- ĞĞ°Ğ²Ñ‹ĞºĞ¸ -->
    <div class="panel" id="skills" style="display:none;">
      <h3>ğŸŒŸ Ğ”Ñ€ĞµĞ²Ğ¾ Ğ½Ğ°Ğ²Ñ‹ĞºĞ¾Ğ²</h3>
      <p><button onclick="upgradeSkill('str')">âš”ï¸ Ğ¡Ğ¸Ğ»Ğ° +1</button></p>
      <p><button onclick="upgradeSkill('def')">ğŸ›¡ï¸ Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° +1</button></p>
      <p><button onclick="upgradeSkill('int')">ğŸ“– ĞœĞ°Ğ³Ğ¸Ñ +1</button></p>
      <p><button onclick="upgradeSkill('agi')">ğŸ¹ Ğ›Ğ¾Ğ²ĞºĞ¾ÑÑ‚ÑŒ +1</button></p>
    </div>
  </div>

<script>
  const tg = window.Telegram.WebApp;

  let level = 1, exp = 0, expToNext = 100;
  let skillPoints = 0;

  // Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ ÑÑ‚Ğ°Ñ‚Ñ‹
  let stats = { hp: 100, mp: 50, str: 10, def: 5, int: 5, agi: 5 };

  let inventory = [];
  let equipment = { weapon: null, armor: null, accessory: null };

  // Ğ›ÑƒÑ‚
  const lootTable = [
    {name:"ĞœĞµÑ‡ Ğ½Ğ¾Ğ²Ğ¸Ñ‡ĞºĞ°", img:"https://i.ibb.co/tMr7JdD/sword.png", rarity:"common", bonus:"+2 ÑĞ¸Ğ»Ğ°", slot:"weapon", stats:{str:2}},
    {name:"Ğ¡Ñ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ñ‰Ğ¸Ñ‚", img:"https://i.ibb.co/FXpFQ7W/shield.png", rarity:"rare", bonus:"+5 Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ°", slot:"armor", stats:{def:5}},
    {name:"ĞšĞ¾Ğ»ÑŒÑ†Ğ¾ Ğ¼Ğ°Ğ³Ğ°", img:"https://i.ibb.co/zf6V0cQ/magic-ring.png", rarity:"epic", bonus:"+8 Ğ¸Ğ½Ñ‚ĞµĞ»Ğ»ĞµĞºÑ‚", slot:"accessory", stats:{int:8}},
    {name:"Ğ—ĞµĞ»ÑŒĞµ HP", img:"https://i.ibb.co/vXBKyMc/hp-potion.png", rarity:"common", bonus:"Ğ’Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ 50 HP", slot:"consumable", heal:50},
    {name:"Ğ›ĞµĞ³ĞµĞ½Ğ´Ğ°Ñ€Ğ½Ñ‹Ğ¹ Ğ¼ĞµÑ‡", img:"https://i.ibb.co/SRVdXy1/legendary-sword.png", rarity:"legendary", bonus:"+15 ÑĞ¸Ğ»Ğ° +5% ĞºÑ€Ğ¸Ñ‚", slot:"weapon", stats:{str:15, agi:5}}
  ];

  const monsters = [
    {name:"Ğ“Ğ¾Ğ±Ğ»Ğ¸Ğ½", img:"https://i.ibb.co/zJVRr0p/goblin.png"},
    {name:"ĞÑ€Ğº", img:"https://i.ibb.co/Lrb6n5z/orc.png"},
    {name:"Ğ”Ñ€Ğ°ĞºĞ¾Ğ½", img:"https://i.ibb.co/VtB8zWg/dragon.png"}
  ];

  function attack() {
    let monster = monsters[Math.floor(Math.random() * monsters.length)];
    let loot = lootTable[Math.floor(Math.random() * lootTable.length)];
    let expGain = Math.floor(Math.random() * 30) + 20;

    exp += expGain;
    if (exp >= expToNext) {
      level++;
      skillPoints++;
      exp = exp - expToNext;
      expToNext += 50;
      document.getElementById("log").innerHTML = `ğŸ”¥ ĞĞ¾Ğ²Ñ‹Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ ${level}! ĞÑ‡ĞºĞ¸ Ğ½Ğ°Ğ²Ñ‹ĞºĞ¾Ğ²: +1`;
    } else {
      document.getElementById("log").innerHTML = `âš”ï¸ ĞŸĞ¾Ğ±ĞµĞ¶Ğ´Ñ‘Ğ½ ${monster.name}! Ğ”Ñ€Ğ¾Ğ¿: ${loot.name}, +${expGain} XP.`;
    }

    inventory.push(loot);
    updateUI();
  }

  function updateUI() {
    document.getElementById("level").textContent = level;
    document.getElementById("exp").textContent = exp;
    document.getElementById("skill-points").textContent = skillPoints;
    document.getElementById("stat-hp").textContent = stats.hp;
    document.getElementById("stat-mp").textContent = stats.mp;
    document.getElementById("stat-str").textContent = stats.str;
    document.getElementById("stat-def").textContent = stats.def;
    document.getElementById("stat-int").textContent = stats.int;
    document.getElementById("stat-agi").textContent = stats.agi;
  }

  function showInventory() {
    toggle("inventory");
    document.getElementById("items").innerHTML = inventory.map(
      (i, idx) => `<li class="inv-item" onclick="equip(${idx})">
        <img src="${i.img}">
        <span class="rarity-${i.rarity}">${i.name}</span> - ${i.bonus}
      </li>`
    ).join("");
  }

  function showEquipment() {
    toggle("equipment");
    document.getElementById("slot-weapon").textContent = equipment.weapon ? equipment.weapon.name : "-";
    document.getElementById("slot-armor").textContent = equipment.armor ? equipment.armor.name : "-";
    document.getElementById("slot-accessory").textContent = equipment.accessory ? equipment.accessory.name : "-";
  }

  function showStats() { toggle("stats"); }
  function showSkills() { toggle("skills"); }

  function toggle(id) {
    let el = document.getElementById(id);
    el.style.display = el.style.display === "none" ? "block" : "none";
  }

  function equip(index) {
    let item = inventory[index];
    if (item.slot === "consumable") {
      stats.hp += item.heal;
      document.getElementById("log").innerHTML = `ğŸ§ª Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¾: ${item.name} (+${item.heal} HP)`;
      inventory.splice(index, 1);
    } else {
      equipment[item.slot] = item;
      applyStats(item.stats);
      document.getElementById("log").innerHTML = `âœ… Ğ­ĞºĞ¸Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½: ${item.name}`;
    }
    updateUI();
    showInventory();
    showEquipment();
  }

  function applyStats(bonus) {
    for (let key in bonus) stats[key] += bonus[key];
  }

  function upgradeSkill(type) {
    if (skillPoints > 0) {
      stats[type] += 1;
      skillPoints--;
      document.getElementById("log").innerHTML = `ğŸŒŸ ĞĞ°Ğ²Ñ‹Ğº ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½: ${type}`;
      updateUI();
    } else {
      document.getElementById("log").innerHTML = `âŒ ĞĞµÑ‚ Ğ¾Ñ‡ĞºĞ¾Ğ² Ğ½Ğ°Ğ²Ñ‹ĞºĞ¾Ğ²`;
    }
  }

  updateUI();
</script>
</body>
</html>
