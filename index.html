<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<title>Mini-RPG —Å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–º–∏ –æ—Ç–∫—Ä—ã—Ç—ã–º–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  body { background:#111; color:#fff; font-family: Arial, sans-serif; text-align:center; margin:0; padding:0;}
  #game { margin:20px auto; width:95vw; max-width:600px; height:50vw; max-height:600px; border:2px solid #fff; border-radius:10px; background:#222; position:relative; overflow:hidden; }
  .character, .monster { width:60px; height:60px; position:absolute; border-radius:8px; box-shadow: 0 0 10px #000a; }
  .character img, .monster img { width:100%; height:100%; border-radius:8px; image-rendering:pixelated; }
  /* –°—Ç–∏–ª–∏ –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤, –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è, –∫–Ω–æ–ø–æ–∫ –∏ –ª–æ–≥–æ–≤ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ */
</style>
</head>
<body>

<h1>Mini-RPG Demo</h1>

<div id="game" aria-label="–ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ" role="main" tabindex="0"></div>

<div id="status" style="max-width:600px; margin:10px auto; text-align:left;">
  HP: <progress id="hpBar" value="100" max="100" style="width:100%"></progress><br/>
  MP: <progress id="mpBar" value="50" max="50" style="width:100%;"></progress><br/>
  EXP: <progress id="expBar" value="0" max="100" style="width:100%;"></progress><br/>
  Level: <span id="levelDisplay">1</span> | VIP: <span id="vipDisplay">0</span> | Coins: <span id="coinsDisplay">0</span>
</div>

<div id="inventory" style="max-width:600px; margin: 10px auto; padding:5px; border:1px solid #fff; border-radius:8px; display:flex; overflow-x:auto; background:#222;"></div>

<div id="log" style="max-width:600px; margin:10px auto; padding:10px; height:150px; overflow-y:auto; border:1px solid white; background:#222; text-align:left; font-size:14px;"></div>

<div id="gameControls" style="max-width:600px; margin:10px auto;">
    <button id="btnDonate" style="padding:10px 20px; font-size:16px; border-radius:8px;">üíé –ü–æ–ø–æ–ª–Ω–∏—Ç—å —Å—á—ë—Ç</button>
    <button id="btnSkills" style="padding:10px 20px; font-size:16px; border-radius:8px;">üßô –î—Ä–µ–≤–æ –Ω–∞–≤—ã–∫–æ–≤</button>
</div>

<!-- –î—Ä–µ–≤–æ –Ω–∞–≤—ã–∫–æ–≤ -->
<div id="skillTreeModal" style="display:none; max-width:600px; margin: 10px auto; padding:15px; background:#222; border:1px solid #fff; border-radius:10px;">
<h2>–î—Ä–µ–≤–æ –Ω–∞–≤—ã–∫–æ–≤</h2>
<div id="skillsList"></div>
<div>–û—á–∫–∏ –Ω–∞–≤—ã–∫–æ–≤: <span id="skillPoints">0</span></div>
<button id="closeSkillTree" style="margin-top:10px; padding:8px 15px;">–ó–∞–∫—Ä—ã—Ç—å</button>
</div>

<script>
const gameDiv = document.getElementById('game');
const invDiv = document.getElementById('inventory');
const logDiv = document.getElementById('log');
const hpBar = document.getElementById('hpBar');
const mpBar = document.getElementById('mpBar');
const expBar = document.getElementById('expBar');
const levelDisplay = document.getElementById('levelDisplay');
const vipDisplay = document.getElementById('vipDisplay');
const coinsDisplay = document.getElementById('coinsDisplay');
const skillTreeModal = document.getElementById('skillTreeModal');
const skillsList = document.getElementById('skillsList');
const skillPointsSpan = document.getElementById('skillPoints');

let player = {
  hp: 100, maxHp: 100,
  mp: 50, maxMp: 50,
  exp: 0, nextLevelExp: 100,
  level:1, coins:0, vipLevel:0,
  firstTopup: true,
  inventory: [],
  equipment: { weapon:null, armor:null, shield:null },
  skillPoints:0,
  skills: {strength:0, agility:0, intelligence:0}
};

// –ü–µ—Ä—Å–æ–Ω–∞–∂
const charDiv = document.createElement('div');
charDiv.className = 'character';
charDiv.style.left = '270px';
charDiv.style.top = '180px';
const charImg = document.createElement('img');
charImg.src = 'https://opengameart.org/sites/default/files/guy_2_1.png'; // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫
charImg.alt = '–ü–µ—Ä—Å–æ–Ω–∞–∂ –∏–≥—Ä–æ–∫–∞';
charDiv.appendChild(charImg);
gameDiv.appendChild(charDiv);

// –ú–æ–±—ã
const monstersData = [
  {id:1, name:'–ì–æ–±–ª–∏–Ω', x:180, y:260, img:'https://opengameart.org/sites/default/files/goblin_1.png', hp:30, maxHp:30},
  {id:2, name:'–°–∫–µ–ª–µ—Ç', x:320, y:260, img:'https://opengameart.org/sites/default/files/skeleton_1.png', hp:25, maxHp:25}
];
const monsterDivs = {};
monstersData.forEach(monster => {
  const mDiv = document.createElement('div');
  mDiv.className = 'monster';
  mDiv.style.left = monster.x + 'px';
  mDiv.style.top = monster.y + 'px';
  mDiv.title = monster.name;
  const mImg = document.createElement('img');
  mImg.src = monster.img;
  mImg.alt = monster.name;
  mDiv.appendChild(mImg);
  gameDiv.appendChild(mDiv);
  monsterDivs[monster.id] = {div: mDiv, data: monster};

  mDiv.addEventListener('click', () => {
    log(`‚öî –£–±–∏–ª–∏ –º–æ–±–∞: ${monster.name}`);
    const loot = generateLoot();
    player.inventory.push(loot);
    log(`üéÅ –í—ã–ø–∞–ª –ª—É—Ç: ${loot.name} (${loot.rarity})`);
    updateInventory();
  });
});

// –õ—É—Ç (—Å—Å—ã–ª–∫–∏ –∏–∑ itch.io c –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞)
const lootPool = [
  {name:"–ú–µ—á –Ω–æ–≤–∏—á–∫–∞", type:"weapon", img:"https://cdn-icons-png.flaticon.com/512/3102/3102601.png", rarity:"common", bonus:{strength:1}},
  {name:"–î–æ—Å–ø–µ—Ö —Ä–µ–¥–∫–∏–π", type:"armor", img:"https://cdn-icons-png.flaticon.com/512/1476/1476600.png", rarity:"rare", bonus:{hp:20}},
  {name:"–©–∏—Ç —ç–ø–∏—á–µ—Å–∫–∏–π", type:"shield", img:"https://cdn-icons-png.flaticon.com/512/925/925292.png", rarity:"epic", bonus:{crit:5}},
  {name:"–ú–µ—á –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π", type:"weapon", img:"https://cdn-icons-png.flaticon.com/512/3544/3544332.png", rarity:"legendary", bonus:{strength:5, crit:10}}
];

function generateLoot(){
  const roll = Math.random();
  if(roll < 0.5) return lootPool[0];
  if(roll < 0.75) return lootPool[1];
  if(roll < 0.9) return lootPool[2];
  return lootPool[3];
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
function updateInventory(){
  invDiv.innerHTML = '';
  player.inventory.forEach((item, idx) => {
    const div = document.createElement('div');
    div.className = 'item';
    div.style.backgroundImage = `url(${item.img})`;
    div.title = `${item.name}\n${item.bonus ? JSON.stringify(item.bonus) : ''}`;
    div.innerHTML = `<span>${item.type}</span>`;
    div.onclick = () => {
      player.equipment[item.type] = item;
      log(`üõ° –≠–∫–∏–ø–∏—Ä–æ–≤–∞–Ω: ${item.name}`);
      updateStatus();
    };
    invDiv.appendChild(div);
  });
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤
function updateStatus(){
  hpBar.value = player.hp;
  hpBar.max = player.maxHp;
  mpBar.value = player.mp;
  mpBar.max = player.maxMp;
  expBar.value = player.exp;
  expBar.max = player.nextLevelExp;
  levelDisplay.textContent = player.level;
  vipDisplay.textContent = player.vipLevel;
  coinsDisplay.textContent = player.coins;
}

// –õ–æ–≥ —Ñ—É–Ω–∫—Ü–∏–π
function log(text){
  logDiv.innerHTML += text + '<br>';
  logDiv.scrollTop = logDiv.scrollHeight;
}

// –î–æ–Ω–∞—Ç
document.getElementById('btnDonate').addEventListener('click', () => {
  const amount = parseInt(prompt('–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è (—á–∏—Å–ª–æ):'), 10);
  if(isNaN(amount) || amount <= 0) return alert('–ù–µ–≤–µ—Ä–Ω–∞—è —Å—É–º–º–∞!');
  player.coins += amount;
  if(player.firstTopup){
    player.firstTopup = false;
    const bonus = lootPool[3];
    player.inventory.push(bonus);
    log('üéâ –ü–µ—Ä–≤–æ–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ! –ü–æ–ª—É—á–µ–Ω –±–æ–Ω—É—Å: ' + bonus.name);
  }
  const vipInc = Math.floor(amount/100);
  player.vipLevel += vipInc;
  player.exp += vipInc * 10;
  log(`üíé –î–æ–Ω–∞—Ç: ${amount} –º–æ–Ω–µ—Ç, VIP +${vipInc}, EXP +${vipInc * 10}`);
  updateInventory();
  updateStatus();
});

// –ù–∞–≤—ã–∫–∏
document.getElementById('btnSkills').addEventListener('click', () => {
  skillTreeModal.style.display = 'block';
  renderSkillTree();
});
document.getElementById('closeSkillTree').addEventListener('click', () => {
  skillTreeModal.style.display = 'none';
});
function renderSkillTree(){
  skillsList.innerHTML = '';
  skillPointsSpan.textContent = player.skillPoints;
  Object.entries(player.skills).forEach(([key,val]) => {
    const div = document.createElement('div');
    div.innerHTML = `${key.toUpperCase()}: ${val} <button data-skill="${key}">+</button>`;
    div.querySelector('button').addEventListener('click', e => {
      if(player.skillPoints>0){
        player.skills[key]++;
        player.skillPoints--;
        log(`üÜô ${key.toUpperCase()} +1`);
        renderSkillTree();
      }
    });
    skillsList.appendChild(div);
  });
}

// –ó–∞–ø—É—Å–∫
updateInventory();
updateStatus();
log('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Mini-RPG! –ö–ª–∏–∫–Ω–∏—Ç–µ –ø–æ –º–æ–±–∞–º, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ª—É—Ç.');

</script>
</body>
</html>