<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>MMO RPG</title>
<style>
body { font-family: Arial, sans-serif; background: #1a1a1a; color: #fff; text-align: center; }
#game { margin: 20px auto; width: 800px; padding: 20px; border: 2px solid #fff; border-radius: 10px; background: #333; }
button { margin: 5px; padding: 10px 20px; font-size: 16px; cursor: pointer; }
#log { text-align: left; margin-top: 20px; height: 200px; overflow-y: auto; border: 1px solid #fff; padding: 10px; }
.inventory { display: flex; flex-wrap: wrap; justify-content: center; margin-top: 10px; }
.item { width: 50px; height: 50px; margin: 5px; border: 1px solid #fff; border-radius: 5px; display: flex; align-items: center; justify-content: center; font-size: 24px; background-size: cover; }
#map { margin-top: 20px; display: grid; grid-template-columns: repeat(3, 80px); grid-gap: 5px; justify-content: center; }
.tile { width: 80px; height: 80px; border: 1px solid #fff; display: flex; align-items: center; justify-content: center; background-size: cover; }
#skillsTree { display:none; margin-top:20px; border:1px solid #fff; padding:10px; }
</style>
</head>
<body>

<div id="game">
    <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ MMO RPG!</h2>

    <!-- –í—ã–±–æ—Ä –∫–ª–∞—Å—Å–∞ -->
    <div id="classSelection">
        <h3>–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞:</h3>
        <button onclick="selectClass('Warrior')">‚öîÔ∏è –í–æ–∏–Ω</button>
        <button onclick="selectClass('Mage')">ü™Ñ –ú–∞–≥</button>
        <button onclick="selectClass('Archer')">üèπ –õ—É—á–Ω–∏–∫</button>
    </div>

    <!-- –í—ã–±–æ—Ä –ø–æ–ª–∞ -->
    <div id="genderSelection" style="display:none;">
        <h3>–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª –ø–µ—Ä—Å–æ–Ω–∞–∂–∞:</h3>
        <button onclick="selectGender('–ú—É–∂—Å–∫–æ–π')">üë® –ú—É–∂—Å–∫–æ–π</button>
        <button onclick="selectGender('–ñ–µ–Ω—Å–∫–∏–π')">üë© –ñ–µ–Ω—Å–∫–∏–π</button>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é -->
    <div id="menu" style="display:none;">
        <h3 id="status"></h3>
        <button onclick="fightCurrentMonster()">üëæ –°—Ä–∞–∑–∏—Ç—å—Å—è —Å –º–æ–Ω—Å—Ç—Ä–æ–º</button>
        <button onclick="showInventory()">üì¶ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</button>
        <button onclick="usePotion('hp')">‚ù§Ô∏è –ó–µ–ª—å–µ HP</button>
        <button onclick="usePotion('mp')">‚ö° –ó–µ–ª—å–µ MP</button>
        <button onclick="showCharacter()">üîÑ –ü–µ—Ä—Å–æ–Ω–∞–∂</button>
        <button onclick="buyVIP()">üíé –ö—É–ø–∏—Ç—å VIP</button>
        <button onclick="donate()">üí∞ –ü–æ–ø–æ–ª–Ω–∏—Ç—å —Å—á–µ—Ç</button>
        <button onclick="openSkills()" id="openSkillsBtn">üß© –î—Ä–µ–≤–æ –Ω–∞–≤—ã–∫–æ–≤</button>
    </div>

    <!-- –ö–∞—Ä—Ç–∞ -->
    <div id="map"></div>

    <!-- –õ–æ–≥ –∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å -->
    <div id="log"></div>
    <div class="inventory" id="inventoryDiv"></div>

    <!-- –î—Ä–µ–≤–æ –Ω–∞–≤—ã–∫–æ–≤ -->
    <div id="skillsTree">
        <h3>–î—Ä–µ–≤–æ –Ω–∞–≤—ã–∫–æ–≤</h3>
        <p>–û—á–∫–∏ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è: <span id="skillPoints">0</span></p>
        <div>–°–∏–ª–∞: <span id="strengthVal">0</span> <button onclick="addStat('strength')">+</button></div>
        <div>–õ–æ–≤–∫–æ—Å—Ç—å: <span id="agilityVal">0</span> <button onclick="addStat('agility')">+</button></div>
        <div>–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç: <span id="intelligenceVal">0</span> <button onclick="addStat('intelligence')">+</button></div>
        <div>HP: <span id="hpVal">0</span> <button onclick="addStat('hp')">+</button></div>
        <div>MP: <span id="mpVal">0</span> <button onclick="addStat('mp')">+</button></div>
        <button onclick="closeSkills()">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
</div>

<script>
// –ò–≥—Ä–æ–∫
let player = null;
let playerPos = {x:1,y:1};

// –õ—É—Ç —Å –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏
const lootTable = [
    {name: "–ú–µ—á", icon:"üó°Ô∏è", img:"https://i.imgur.com/OY8o0jA.png"},
    {name: "–©–∏—Ç", icon:"üõ°Ô∏è", img:"https://i.imgur.com/Ny3uXgD.png"},
    {name: "–ó–µ–ª—å–µ HP", icon:"‚ù§Ô∏è", img:"https://i.imgur.com/7c3tN2B.png"},
    {name: "–ó–µ–ª—å–µ MP", icon:"‚ö°", img:"https://i.imgur.com/dz5eK4V.png"},
    {name: "–ü–æ—Å–æ—Ö", icon:"ü™Ñ", img:"https://i.imgur.com/Q0Jz5cA.png"},
    {name: "–õ—É–∫", icon:"üèπ", img:"https://i.imgur.com/q4U0pqG.png"}
];

// –ú–æ–Ω—Å—Ç—Ä—ã —Å –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏
const monsters = [
    {name:"–°–∫–µ–ª–µ—Ç", hp:30, exp:20, img:"https://i.imgur.com/EhFz7ON.png"},
    {name:"–ó–æ–º–±–∏", hp:40, exp:30, img:"https://i.imgur.com/4YbUJ95.png"},
    {name:"–î—Ä–∞–∫–æ–Ω", hp:80, exp:100, img:"https://i.imgur.com/9RjCrgB.png"}
];

// –ö–∞—Ä—Ç–∞ —Å –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏ —Ç–∞–π–ª–æ–≤
const mapTiles = [
    [{name:"–õ–µ—Å", img:"https://i.imgur.com/lfkz2Tq.png"}, {name:"–†–µ–∫–∞", img:"https://i.imgur.com/ZL3qYwM.png"}, {name:"–ì–æ—Ä—ã", img:"https://i.imgur.com/5E5rPYo.png"}],
    [{name:"–î–µ—Ä–µ–≤–Ω—è", img:"https://i.imgur.com/XlOqZpV.png"}, {name:"–ü–æ–ª—è–Ω–∞", img:"https://i.imgur.com/q0q6sDq.png"}, {name:"–ü–µ—â–µ—Ä–∞", img:"https://i.imgur.com/lqP5zRz.png"}],
    [{name:"–ó–∞–º–æ–∫", img:"https://i.imgur.com/Vhrm9kB.png"}, {name:"–¢—É–Ω–¥—Ä–∞", img:"https://i.imgur.com/ZgU6e1d.png"}, {name:"–ü—É—Å—Ç–æ—à—å", img:"https://i.imgur.com/GkH0W9n.png"}]
];

// –õ–æ–≥
function log(msg){ const logDiv = document.getElementById("log"); logDiv.innerHTML += msg+"<br>"; logDiv.scrollTop = logDiv.scrollHeight; }

// –í—ã–±–æ—Ä –∫–ª–∞—Å—Å–∞
function selectClass(cls){
    if(player) return;
    player = {class:cls, level:1, exp:0, nextLevelExp:100, coins:0, vip:false, firstDonationReceived:false, skillPoints:0,
              inventory:[], hp:cls==="Warrior"?120:cls==="Mage"?60:cls==="Archer"?80:80,
              maxHp:cls==="Warrior"?120:cls==="Mage"?60:cls==="Archer"?80:80,
              mp:cls==="Warrior"?30:cls==="Mage"?100:cls==="Archer"?50:50,
              strength:cls==="Warrior"?20:cls==="Mage"?5:cls==="Archer"?10:10,
              agility:cls==="Warrior"?10:cls==="Mage"?10:cls==="Archer"?15:10,
              intelligence:cls==="Warrior"?5:cls==="Mage"?20:cls==="Archer"?10:10};
    document.getElementById("classSelection").style.display="none";
    document.getElementById("genderSelection").style.display="block";
}

// –í—ã–±–æ—Ä –ø–æ–ª–∞
function selectGender(gender){
    player.gender = gender;
    document.getElementById("genderSelection").style.display="none";
    document.getElementById("menu").style.display="block";
    document.getElementById("openSkillsBtn").style.display="inline-block";
    renderMap();
    updateStatus();
    log(`–í—ã –≤—ã–±—Ä–∞–ª–∏ –∫–ª–∞—Å—Å ${player.class}, –ø–æ–ª: ${gender}`);
}

// –°—Ç–∞—Ç—É—Å
function updateStatus(){
    let genderEmoji = player.gender==="–ú—É–∂—Å–∫–æ–π"?"üë®":"üë©";
    document.getElementById("status").innerText=`${genderEmoji} ${player.class} - LV:${player.level} HP:${player.hp}/${player.maxHp} MP:${player.mp}/${player.maxMp} üíé${player.coins}`;
}

// –†–µ–Ω–¥–µ—Ä –∫–∞—Ä—Ç—ã
function renderMap(){
    const mapDiv = document.getElementById("map"); mapDiv.innerHTML="";
    for(let y=0;y<3;y++){
        for(let x=0;x<3;x++){
            const tile = document.createElement("div");
            tile.className="tile";
            tile.style.backgroundImage=`url(${mapTiles[y][x].img})`;
            if(playerPos.x===x && playerPos.y===y){ tile.innerHTML=`<strong>üßë</strong>`; }
            tile.onclick = ()=>{playerPos.x=x; playerPos.y=y; renderMap(); spawnMonster(mapTiles[y][x]); updateStatus();};
            mapDiv.appendChild(tile);
        }
    }
}

// –ú–æ–Ω—Å—Ç—Ä—ã
function spawnMonster(tile){
    if(!tile.currentMonster){
        const monster = {...monsters[Math.floor(Math.random()*monsters.length)]};
        tile.currentMonster = monster;
        log(`üëæ –í —ç—Ç–æ–π –∑–æ–Ω–µ –ø–æ—è–≤–∏–ª—Å—è –º–æ–Ω—Å—Ç—Ä: ${monster.name}`);
    }
}

// –ë–æ–π
function fightCurrentMonster(){
    const tile = mapTiles[playerPos.y][playerPos.x];
    if(!tile.currentMonster){ log("‚ùå –ó–¥–µ—Å—å –Ω–µ—Ç –º–æ–Ω—Å—Ç—Ä–æ–≤"); return; }
    const monster = tile.currentMonster;
    const playerDamage = Math.floor(Math.random()*monster.hp/2)+10;
    const damage = Math.floor(Math.random()*player.hp/3)+5;
    if(playerDamage>=monster.hp){
        const loot = lootTable[Math.floor(Math.random()*lootTable.length)];
        player.inventory.push(loot); player.exp += monster.exp; player.coins += Math.floor(Math.random()*20)+5;
        log(`üéâ –í—ã –ø–æ–±–µ–¥–∏–ª–∏ ${monster.name} –∏ –ø–æ–ª—É—á–∏–ª–∏: ${loot.icon} ${loot.name}, –æ–ø—ã—Ç: ${monster.exp}, –º–æ–Ω–µ—Ç—ã: ${player.coins}`);
        levelUp(); updateInventory(); tile.currentMonster=null;
    } else {
        player.hp -= damage;
        if(player.hp<=0){ player.hp=0; log("üíÄ –í—ã –±—ã–ª–∏ –ø–æ–±–µ–∂–¥–µ–Ω—ã!"); }
        else log(`üëæ –°—Ä–∞–∂–µ–Ω–∏–µ —Å ${monster.name}, –ø–æ–ª—É—á–∏–ª–∏ ${damage} —É—Ä–æ–Ω–∞`);
    }
    updateStatus();
}

// –û—Å—Ç–∞–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª: –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å, –∑–µ–ª—å—è, VIP, –¥–æ–Ω–∞—Ç, –¥—Ä–µ–≤–æ –Ω–∞–≤—ã–∫–æ–≤ ‚Äî –º–æ–∂–Ω–æ –≤–∑—è—Ç—å –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏
function updateInventory(){
    const invDiv = document.getElementById("inventoryDiv"); invDiv.innerHTML="";
    for(const item of player.inventory){ const div=document.createElement("div"); div.className="item"; div.style.backgroundImage=`url(${item.img})`; div.title=item.name; invDiv.appendChild(div);}
}
function showInventory(){ updateInventory(); }
function usePotion(type){ if(type==="hp"){ player.hp=Math.min(player.hp+50,player.maxHp); log("‚ù§Ô∏è –í—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –∑–µ–ª—å–µ HP"); } if(type==="mp"){ player.mp=Math.min(player.mp+30,player.maxMp); log("‚ö° –í—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –∑–µ–ª—å–µ MP"); } updateStatus(); }
function showCharacter(){ log(`üßë‚Äçüíª ${player.gender} ${player.class} | LV:${player.level} | HP:${player.hp}/${player.maxHp} MP:${player.mp}/${player.maxMp} üíé${player.coins}`); }
function buyVIP(){ if(player.vip){ log("–í—ã —É–∂–µ VIP!"); return; } if(player.coins>=50){ player.coins-=50; player.vip=true; log("üíé –í—ã —Å—Ç–∞–ª–∏ VIP!"); updateInventory(); updateStatus(); } else log("üí∞ –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç –¥–ª—è –ø–æ–∫—É–ø–∫–∏ VIP (50 –º–æ–Ω–µ—Ç)"); }
function donate(){ const amount = prompt("–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è:"); if(amount>0){ player.coins+=parseInt(amount); log(`üí∞ –í—ã –ø–æ–ø–æ–ª–Ω–∏–ª–∏ —Å—á–µ—Ç –Ω–∞ ${amount} –º–æ–Ω–µ—Ç`); updateStatus(); } }

// –î—Ä–µ–≤–æ –Ω–∞–≤—ã–∫–æ–≤
function openSkills(){ document.getElementById("skillsTree").style.display="block"; }
function closeSkills(){ document.getElementById("skillsTree").style.display="none"; }
function addStat(stat){ if(player.skillPoints<=0) return; if(stat==="hp") player.maxHp+=10; else if(stat==="mp") player.maxMp+=10; else player[stat]+=1; player.skillPoints--; updateSkillsDisplay(); updateStatus(); }
function updateSkillsDisplay(){ document.getElementById("skillPoints").innerText=player.skillPoints; document.getElementById("strengthVal").innerText=player.strength; document.getElementById("agilityVal").innerText=player.agility; document.getElementById("intelligenceVal").innerText=player.intelligence; document.getElementById("hpVal").innerText=player.maxHp; document.getElementById("mpVal").innerText=player.maxMp; }

</script>

</body>
</html>
