<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>MMO RPG</title>
<style>
body { font-family: Arial, sans-serif; background: #1a1a1a; color: #fff; text-align: center; }
#game { margin: 20px auto; width: 720px; padding: 20px; border: 2px solid #fff; border-radius: 10px; background: #333; }
button { margin: 5px; padding: 10px 20px; font-size: 16px; cursor: pointer; }
#log { text-align: left; margin-top: 20px; height: 250px; overflow-y: auto; border: 1px solid #fff; padding: 10px; }
.inventory { display: flex; flex-wrap: wrap; justify-content: center; margin-top: 10px; }
.item { width: 40px; height: 40px; margin: 5px; border: 1px solid #fff; border-radius: 5px; display: flex; align-items: center; justify-content: center; font-size: 20px; }
.skin { width: 60px; height: 60px; margin: 5px; border: 2px solid #fff; border-radius: 50%; display: inline-block; background-size: cover; cursor: pointer; }
#map { margin-top: 20px; }
</style>
</head>
<body>

<div id="game">
    <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ MMO RPG!</h2>

    <!-- –í—ã–±–æ—Ä –∫–ª–∞—Å—Å–∞ -->
    <div id="classSelection">
        <h3>–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞:</h3>
        <button onclick="selectClass('Warrior')">‚öîÔ∏è –í–æ–∏–Ω</button>
        <button onclick="selectClass('Mage')">ü™Ñ –ú–∞–≥</button>
        <button onclick="selectClass('Archer')">üèπ –õ—É—á–Ω–∏–∫</button>
    </div>

    <!-- –í—ã–±–æ—Ä —Å–∫–∏–Ω–∞ -->
    <div id="skinSelection" style="display:none;">
        <h3>–í—ã–±–µ—Ä–∏—Ç–µ —Å–∫–∏–Ω:</h3>
        <div class="skin" onclick="selectSkin('Red')" style="background-color:#ff0000;"></div>
        <div class="skin" onclick="selectSkin('Blue')" style="background-color:#0000ff;"></div>
        <div class="skin" onclick="selectSkin('Green')" style="background-color:#00ff00;"></div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é -->
    <div id="menu" style="display:none;">
        <h3 id="status"></h3>
        <button onclick="fightCurrentMonster()">üëæ –°—Ä–∞–∑–∏—Ç—å—Å—è —Å –º–æ–Ω—Å—Ç—Ä–æ–º</button>
        <button onclick="showInventory()">üì¶ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</button>
        <button onclick="usePotion('hp')">‚ù§Ô∏è –ó–µ–ª—å–µ HP</button>
        <button onclick="usePotion('mp')">‚ö° –ó–µ–ª—å–µ MP</button>
        <button onclick="showCharacter()">üîÑ –ü–µ—Ä—Å–æ–Ω–∞–∂</button>
        <button onclick="buyVIP()">üíé –ö—É–ø–∏—Ç—å VIP</button>
    </div>

    <!-- –ö–∞—Ä—Ç–∞ -->
    <div id="map" style="display:none;">
        <h3>–ö–∞—Ä—Ç–∞</h3>
        <div id="zoneName"></div>
        <button onclick="move('up')">‚¨ÜÔ∏è –í–≤–µ—Ä—Ö</button>
        <button onclick="move('down')">‚¨áÔ∏è –í–Ω–∏–∑</button>
        <button onclick="move('left')">‚¨ÖÔ∏è –í–ª–µ–≤–æ</button>
        <button onclick="move('right')">‚û°Ô∏è –í–ø—Ä–∞–≤–æ</button>
    </div>

    <div id="log"></div>
    <div class="inventory" id="inventoryDiv"></div>
</div>

<script>
// –ò–≥—Ä–æ–∫
let player = null;

// –õ—É—Ç
const lootTable = [
    {name: "–ú–µ—á", icon: "üó°Ô∏è", rarity:"common"},
    {name: "–©–∏—Ç", icon: "üõ°Ô∏è", rarity:"common"},
    {name: "–ó–µ–ª—å–µ HP", icon: "‚ù§Ô∏è", rarity:"common"},
    {name: "–ó–µ–ª—å–µ MP", icon: "‚ö°", rarity:"common"},
    {name: "–ü–æ—Å–æ—Ö", icon: "ü™Ñ", rarity:"rare"},
    {name: "–õ—É–∫", icon: "üèπ", rarity:"rare"}
];

// –ú–æ–Ω—Å—Ç—Ä—ã
const monsters = [
    {name:"–°–∫–µ–ª–µ—Ç", hp:30, exp:20},
    {name:"–ó–æ–º–±–∏", hp:40, exp:30},
    {name:"–î—Ä–∞–∫–æ–Ω", hp:80, exp:100}
];

// –ö–∞—Ä—Ç–∞ 3x3
const map = [
    [{name:"–õ–µ—Å"}, {name:"–†–µ–∫–∞"}, {name:"–ì–æ—Ä—ã"}],
    [{name:"–î–µ—Ä–µ–≤–Ω—è"}, {name:"–ü–æ–ª—è–Ω–∞"}, {name:"–ü–µ—â–µ—Ä–∞"}],
    [{name:"–ó–∞–º–æ–∫"}, {name:"–¢—É–Ω–¥—Ä–∞"}, {name:"–ü—É—Å—Ç–æ—à—å"}]
];
let playerPos = {x:1, y:1};

// –õ–æ–≥
function log(msg){
    const logDiv = document.getElementById("log");
    logDiv.innerHTML += msg + "<br>";
    logDiv.scrollTop = logDiv.scrollHeight;
}

// –í—ã–±–æ—Ä –∫–ª–∞—Å—Å–∞
function selectClass(cls){
    if(player) return;
    player = {
        name:"–ò–≥—Ä–æ–∫",
        class:cls,
        skin:"Default",
        level:1,
        exp:0,
        nextLevelExp:100,
        hp: cls==="Warrior"?120:cls==="Mage"?60:80,
        maxHp: cls==="Warrior"?120:cls==="Mage"?60:80,
        mp: cls==="Warrior"?30:cls==="Mage"?100:50,
        maxMp: cls==="Warrior"?30:cls==="Mage"?100:50,
        strength: cls==="Warrior"?20:cls==="Mage"?5:10,
        agility: cls==="Warrior"?10:cls==="Mage"?10:15,
        intelligence: cls==="Warrior"?5:cls==="Mage"?20:10,
        inventory: [],
        coins: 0,
        vip: false,
        firstDonationReceived:false
    };
    document.getElementById("classSelection").style.display="none";
    document.getElementById("skinSelection").style.display="block";
}

// –í—ã–±–æ—Ä —Å–∫–∏–Ω–∞
function selectSkin(skin){
    player.skin = skin;
    document.getElementById("skinSelection").style.display="none";
    document.getElementById("menu").style.display="block";
    document.getElementById("map").style.display="block";
    updateStatus();
    log(`–í—ã –≤—ã–±—Ä–∞–ª–∏ –∫–ª–∞—Å—Å ${player.class} —Å–∫–∏–Ω–æ–º ${skin}`);
    updateZone();
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
function updateStatus(){
    document.getElementById("status").innerText = `${player.class} - LV:${player.level} HP:${player.hp}/${player.maxHp} MP:${player.mp}/${player.maxMp} üíé${player.coins}`;
}

// –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –ø–æ –∫–∞—Ä—Ç–µ
function move(direction){
    if(direction==="up" && playerPos.y>0) playerPos.y--;
    if(direction==="down" && playerPos.y<2) playerPos.y++;
    if(direction==="left" && playerPos.x>0) playerPos.x--;
    if(direction==="right" && playerPos.x<2) playerPos.x++;
    updateZone();
}

function updateZone(){
    const zone = map[playerPos.y][playerPos.x];
    document.getElementById("zoneName").innerText = `–ó–æ–Ω–∞: ${zone.name}`;
    spawnMonster(zone);
}

// –°–ø–∞–≤–Ω –º–æ–Ω—Å—Ç—Ä–æ–≤
function spawnMonster(zone){
    if(!zone.currentMonster){
        const monster = {...monsters[Math.floor(Math.random()*monsters.length)]};
        zone.currentMonster = monster;
        log(`üëæ –í —ç—Ç–æ–π –∑–æ–Ω–µ –ø–æ—è–≤–∏–ª—Å—è –º–æ–Ω—Å—Ç—Ä: ${monster.name}`);
    }
}

// –ë–æ–π —Å –º–æ–Ω—Å—Ç—Ä–æ–º
function fightCurrentMonster(){
    const zone = map[playerPos.y][playerPos.x];
    if(!zone.currentMonster) { log("‚ùå –ó–¥–µ—Å—å –Ω–µ—Ç –º–æ–Ω—Å—Ç—Ä–æ–≤"); return; }
    const monster = zone.currentMonster;

    const damage = Math.floor(Math.random()*player.hp/3)+5;
    const playerDamage = Math.floor(Math.random()*monster.hp/2)+10;

    if(playerDamage>=monster.hp){
        const loot = lootTable[Math.floor(Math.random()*lootTable.length)];
        player.inventory.push(loot);
        player.exp += monster.exp;
        player.coins += Math.floor(Math.random()*20)+5;
        log(`üéâ –í—ã –ø–æ–±–µ–¥–∏–ª–∏ ${monster.name} –∏ –ø–æ–ª—É—á–∏–ª–∏: ${loot.icon} ${loot.name}, –æ–ø—ã—Ç: ${monster.exp}, –º–æ–Ω–µ—Ç—ã: ${player.coins}`);
        levelUp();
        updateInventory();
        zone.currentMonster = null;
    } else {
        player.hp -= damage;
        if(player.hp<=0){ player.hp=0; log("üíÄ –í—ã –±—ã–ª–∏ –ø–æ–±–µ–∂–¥–µ–Ω—ã!"); }
        else log(`üëæ –°—Ä–∞–∂–µ–Ω–∏–µ —Å ${monster.name}, –ø–æ–ª—É—á–∏–ª–∏ ${damage} —É—Ä–æ–Ω–∞`);
    }
    updateStatus();
}

// –ü–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è
function levelUp(){
    while(player.exp >= player.nextLevelExp){
        player.level++;
        player.exp -= player.nextLevelExp;
        player.nextLevelExp = Math.floor(player.nextLevelExp*1.5);
        player.maxHp += 20;
        player.maxMp += 10;
        player.hp = player.maxHp;
        player.mp = player.maxMp;
        log(`üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ —É—Ä–æ–≤–Ω—è ${player.level}`);
    }
}

// –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å
function showInventory(){ updateInventory(); }
function updateInventory(){
    const invDiv = document.getElementById("inventoryDiv");
    invDiv.innerHTML="";
    for(const item of player.inventory){
        const div = document.createElement("div");
        div.className="item";
        div.innerText = item.icon;
        div.title = item.name;
        invDiv.appendChild(div);
    }
}

// –ó–µ–ª—å—è
function usePotion(type){
    if(type==="hp"){
        player.hp = Math.min(player.hp+50, player.maxHp);
        log("‚ù§Ô∏è –í—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –∑–µ–ª—å–µ –∑–¥–æ—Ä–æ–≤—å—è");
    }
    if(type==="mp"){
        player.mp = Math.min(player.mp+30, player.maxMp);
        log("‚ö° –í—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –∑–µ–ª—å–µ –º–∞–Ω—ã");
    }
    updateStatus();
}

// –ü–æ–∫–∞–∑ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
function showCharacter(){
    log(`üßë‚Äçüíª ${player.name} | –ö–ª–∞—Å—Å: ${player.class} | –°–∫–∏–Ω: ${player.skin} | LV:${player.level} | HP:${player.hp}/${player.maxHp} MP:${player.mp}/${player.maxMp} üíé${player.coins}`);
}

// VIP
function buyVIP(){
    if(player.vip){ log("–í—ã —É–∂–µ VIP!"); return; }
    if(player.coins >= 50){
        player.coins -= 50;
        player.vip = true;
        if(!player.firstDonationReceived){
            const bonus = {name:"–≠–ø–∏—á–µ—Å–∫–∏–π –ú–µ—á", icon:"‚öîÔ∏è", rarity:"epic"};
            player.inventory.push(bonus);
            player.firstDonationReceived = true;
            log("üíé –í—ã —Å—Ç–∞–ª–∏ VIP! –ü–æ–ª—É—á–∏–ª–∏ –±–æ–Ω—É—Å–Ω–æ–µ —Å–Ω–∞—Ä—è–∂–µ–Ω–∏–µ: " + bonus.icon + " " + bonus.name);
        } else { log("üíé –í—ã —Å—Ç–∞–ª–∏ VIP!"); }
        updateInventory();
        updateStatus();
    } else { log("üí∞ –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç –¥–ª—è –ø–æ–∫—É–ø–∫–∏ VIP (50 –º–æ–Ω–µ—Ç)"); }
}
</script>

</body>
</html>
