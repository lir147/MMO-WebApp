<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Mini-MMORPG —Å VIP –∏ –º–∞–≥–∞–∑–∏–Ω–æ–º</title>
<style>
body { font-family: Arial; background:#111; color:#fff; text-align:center; }
#game { margin:20px auto; width:400px; height:400px; border:2px solid #fff; border-radius:10px; background:#222; position:relative; overflow:hidden; }
.tile { width:80px; height:80px; float:left; border:1px solid #444; background-size:cover; position:relative; }
.character, .monster, .loot, .effect, .shop { width:60px; height:60px; position:absolute; transition:all 0.3s ease; }
.character img, .monster img, .loot img, .effect img, .shop img { width:100%; height:100%; }
.damage { position:absolute; font-weight:bold; color:red; animation:up 1s forwards; }
@keyframes up { 0% { opacity:1; transform:translateY(0); } 100% { opacity:0; transform:translateY(-40px); } }
.effectAnim { animation:effectAnim 0.5s forwards; }
@keyframes effectAnim { 0% {opacity:1; transform:scale(0.5);} 100% {opacity:0; transform:scale(1.5);} }
#log { clear:both; text-align:left; height:150px; overflow-y:auto; margin-top:10px; border:1px solid #fff; padding:5px; }
.item { width:50px; height:50px; margin:5px; display:inline-block; background-size:cover; border:1px solid #fff; border-radius:5px; cursor:pointer; }
button { margin:5px; padding:8px 12px; }
#skills { margin-top:10px; }
.skill { display:inline-block; width:80px; height:80px; border:1px solid #fff; margin:3px; line-height:80px; cursor:pointer; }
</style>
</head>
<body>

<h2>Mini-MMORPG 5x5 —Å VIP</h2>
<div>
    –ö–ª–∞—Å—Å:
    <button onclick="selectClass('Warrior')">–í–æ–∏–Ω</button>
    <button onclick="selectClass('Mage')">–ú–∞–≥</button>
    <button onclick="selectClass('Archer')">–õ—É—á–Ω–∏–∫</button>
</div>
<div>
    –ü–æ–ª:
    <button onclick="selectGender('male')">–ú—É–∂—Å–∫–æ–π</button>
    <button onclick="selectGender('female')">–ñ–µ–Ω—Å–∫–∏–π</button>
</div>

<div id="game"></div>
<div>
    <button onclick="buyVIP()">üíé VIP</button>
    <button onclick="donate()">üí∞ –ü–æ–ø–æ–ª–Ω–∏—Ç—å —Å—á–µ—Ç</button>
</div>
<div id="log"></div>
<div id="inventory"></div>
<div id="skills"></div>

<script>
// –ò–≥—Ä–æ–∫
let player = {
    x:2,y:2,hp:100,maxHp:100,mp:50,maxMp:50,
    strength:10,agility:10,intelligence:10,
    inventory:[],level:1,exp:0,nextLevelExp:100,coins:0,
    vip:false,vipLevel:0,skillPoints:0,
    class:'',gender:'',equipment:{weapon:null,shield:null,armor:null}
};

let monsters = [];
let lootTable = [
    {name:"–ú–µ—á", img:"https://i.imgur.com/OY8o0jA.png",type:"weapon"},
    {name:"–©–∏—Ç", img:"https://i.imgur.com/Ny3uXgD.png",type:"shield"},
    {name:"–ó–µ–ª—å–µ HP", img:"https://i.imgur.com/7c3tN2B.png",type:"hp"},
    {name:"–ó–µ–ª—å–µ MP", img:"https://i.imgur.com/3Q6RtEv.png",type:"mp"}
];

const mapDiv = document.getElementById("game");
const tileSize = 80;
let mapTiles = [];
for(let y=0;y<5;y++){
    mapTiles[y]=[];
    for(let x=0;x<5;x++){
        const tile = document.createElement("div");
        tile.className="tile";
        tile.style.backgroundImage=`url('https://i.imgur.com/lfkz2Tq.png')`;
        tile.style.left = x*tileSize+"px";
        tile.style.top = y*tileSize+"px";
        mapDiv.appendChild(tile);
        mapTiles[y][x]=tile;
    }
}

// –ü–µ—Ä—Å–æ–Ω–∞–∂
const characterDiv = document.createElement("div");
characterDiv.className="character";
characterDiv.style.left=player.x*tileSize+10+"px";
characterDiv.style.top=player.y*tileSize+10+"px";
mapDiv.appendChild(characterDiv);

function selectClass(cls){ player.class=cls; log(`–í—ã –≤—ã–±—Ä–∞–ª–∏ –∫–ª–∞—Å—Å: ${cls}`); updateCharacterImage(); }
function selectGender(g){ player.gender=g; log(`–í—ã –≤—ã–±—Ä–∞–ª–∏ –ø–æ–ª: ${g}`); updateCharacterImage(); }
function updateCharacterImage(){
    let img='https://i.imgur.com/4c6wqdn.png';
    if(player.class=='Mage') img='https://i.imgur.com/5Uq2KHu.png';
    if(player.class=='Archer') img='https://i.imgur.com/1vTtOkM.png';
    if(player.gender=='female'){
        if(player.class=='Warrior') img='https://i.imgur.com/3tY7aLp.png';
        if(player.class=='Mage') img='https://i.imgur.com/ZtFJqP1.png';
        if(player.class=='Archer') img='https://i.imgur.com/vl4oZT6.png';
    }
    characterDiv.innerHTML=`<img src="${img}">`;
}

function log(msg){ const logDiv=document.getElementById("log"); logDiv.innerHTML+=msg+"<br>"; logDiv.scrollTop=logDiv.scrollHeight; }

// –°–ø–∞–≤–Ω –º–æ–Ω—Å—Ç—Ä–æ–≤
function spawnMonster(x,y,hp=50,img="https://i.imgur.com/EhFz7ON.png"){
    const monster = {x,y,hp,img};
    monsters.push(monster);
    const mDiv = document.createElement("div");
    mDiv.className="monster";
    mDiv.style.left=x*tileSize+10+"px";
    mDiv.style.top=y*tileSize+10+"px";
    mDiv.innerHTML=`<img src="${img}">`;
    mapDiv.appendChild(mDiv);
    monster.div=mDiv;
    log(`–ú–æ–Ω—Å—Ç—Ä –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ (${x},${y})`);
}

// –°–ø–∞–≤–Ω –ª—É—Ç–∞ –∏ –±–∞–Ω–æ–∫
function spawnLoot(x,y,loot){
    const lDiv = document.createElement("div");
    lDiv.className="loot";
    lDiv.style.left=x*tileSize+10+"px";
    lDiv.style.top=y*tileSize+10+"px";
    lDiv.innerHTML=`<img src="${loot.img}">`;
    lDiv.onclick = ()=>{
        if(loot.type=="weapon"||loot.type=="shield"){
            player.equipment[loot.type]=loot;
            log(`–≠–∫–∏–ø–∏—Ä–æ–≤–∞–Ω ${loot.name}`);
        } else if(loot.type=="hp") { player.hp=Math.min(player.maxHp,player.hp+50); log("üíñ HP –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ"); }
        else if(loot.type=="mp") { player.mp=Math.min(player.maxMp,player.mp+30); log("üîÆ MP –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ"); }
        updateInventory();
        lDiv.remove();
    };
    mapDiv.appendChild(lDiv);
}

// –ú–∞–≥–∞–∑–∏–Ω –∑–µ–ª–∏–π
function spawnShop(x,y){
    const sDiv=document.createElement("div");
    sDiv.className="shop";
    sDiv.style.left=x*tileSize+10+"px";
    sDiv.style.top=y*tileSize+10+"px";
    sDiv.innerHTML=`<img src="https://i.imgur.com/7c3tN2B.png">`;
    sDiv.onclick=()=>{
        const choice=prompt("–ö—É–ø–∏—Ç—å: 1-HP 2-MP (–¶–µ–Ω–∞: 10 –º–æ–Ω–µ—Ç)");
        if(choice=="1" && player.coins>=10){ player.coins-=10; player.hp=Math.min(player.maxHp,player.hp+50); log("üíñ –ö—É–ø–ª–µ–Ω–æ –ó–µ–ª—å–µ HP"); }
        else if(choice=="2" && player.coins>=10){ player.coins-=10; player.mp=Math.min(player.maxMp,player.mp+30); log("üîÆ –ö—É–ø–ª–µ–Ω–æ –ó–µ–ª—å–µ MP"); }
        else log("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç");
    };
    mapDiv.appendChild(sDiv);
}

// –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ
function moveTo(x,y){
    characterDiv.style.left=x*tileSize+10+"px";
    characterDiv.style.top=y*tileSize+10+"px";
    player.x=x; player.y=y;
    const monster = monsters.find(m=>m.x===x && m.y===y);
    if(monster) fight(monster);
}

// –ë–æ–π
function fight(monster){
    let dmg = player.strength + Math.floor(Math.random()*10);
    if(player.vipLevel>0) dmg += player.vipLevel*2; // –±–æ–Ω—É—Å VIP
    const crit = Math.random()<0.2;
    if(crit){ dmg*=2; log("üí• –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É–¥–∞—Ä!"); showEffect(monster.x,monster.y,"üî•"); }
    else showEffect(monster.x,monster.y,"‚öîÔ∏è");

    monster.hp-=dmg;
    const dmgDiv=document.createElement("div");
    dmgDiv.className="damage";
    dmgDiv.innerText=dmg;
    dmgDiv.style.left=monster.x*tileSize+20+"px";
    dmgDiv.style.top=monster.y*tileSize+"px";
    mapDiv.appendChild(dmgDiv);
    setTimeout(()=>{ dmgDiv.remove(); },1000);

    if(monster.hp<=0){
        log(`üíÄ –ú–æ–Ω—Å—Ç—Ä –ø–æ–±–µ–∂–¥–µ–Ω!`);
        monster.div.remove();
        monsters = monsters.filter(m=>m!==monster);
        player.exp+=50;
        if(player.exp>=player.nextLevelExp) levelUp();
        spawnLoot(monster.x,monster.y, lootTable[Math.floor(Math.random()*lootTable.length)]);
    }
}

// –≠—Ñ—Ñ–µ–∫—Ç—ã
function showEffect(x,y,symbol){
    const eDiv=document.createElement("div");
    eDiv.className="effect";
    eDiv.innerHTML=`<div class="effectAnim">${symbol}</div>`;
    eDiv.style.left=x*tileSize+20+"px";
    eDiv.style.top=y*tileSize+10+"px";
    mapDiv.appendChild(eDiv);
    setTimeout(()=>{ eDiv.remove(); },500);
}

// –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å
function updateInventory(){
    const invDiv=document.getElementById("inventory");
    invDiv.innerHTML="";
    for(let key in player.equipment){
        if(player.equipment[key]){
            const div=document.createElement("div");
            div.className="item";
            div.style.backgroundImage=`url(${player.equipment[key].img})`;
            div.title=player.equipment[key].name;
            invDiv.appendChild(div);
        }
    }
}

// –ù–∞–≤—ã–∫–∏
function addSkill(name){
    if(player.skillPoints<=0){ log("–ù–µ—Ç –æ—á–∫–æ–≤ –Ω–∞–≤—ã–∫–æ–≤"); return; }
    if(name=="strength") player.strength+=1;
    if(name=="agility") player.agility+=1;
    if(name=="intelligence") player.intelligence+=1;
    player.skillPoints--;
    log(`–ù–∞–≤—ã–∫ ${name} —É–≤–µ–ª–∏—á–µ–Ω. –û—Å—Ç–∞–ª–æ—Å—å –æ—á–∫–æ–≤: ${player.skillPoints}`);
    renderSkills();
}
function renderSkills(){
    const skDiv=document.getElementById("skills");
    skDiv.innerHTML="";
    ["strength","agility","intelligence"].forEach(s=>{
        const b=document.createElement("div");
        b.className="skill";
        b.innerText=s+"\n"+player[s];
        b.onclick=()=>addSkill(s);
        skDiv.appendChild(b);
    });
}
renderSkills();

// –£—Ä–æ–≤–µ–Ω—å
function levelUp(){
    player.level++;
    player.exp=player.exp-player.nextLevelExp;
    player.nextLevelExp+=50;
    player.skillPoints+=5;
    log(`üîù –£—Ä–æ–≤–µ–Ω—å –ø–æ–≤—ã—à–µ–Ω! –£ –≤–∞—Å ${player.skillPoints} –æ—á–∫–æ–≤ –Ω–∞–≤—ã–∫–æ–≤`);
    renderSkills();
}

// VIP –∏ –¥–æ–Ω–∞—Ç —Å –ø–æ–≤—ã—à–µ–Ω–∏–µ–º —É—Ä–æ–≤–Ω—è VIP
let firstDonation=true;
function buyVIP(){
    if(player.vip){ log("–í—ã —É–∂–µ VIP!"); return; }
    if(player.coins>=50){
        player.coins-=50;
        player.vip=true;
        player.vipLevel++;
        log(`üíé –í—ã —Å—Ç–∞–ª–∏ VIP! –£—Ä–æ–≤–µ–Ω—å VIP: ${player.vipLevel}`);
    } else log("üí∞ –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç –¥–ª—è VIP (50)");
}
function donate(){
    const amount = prompt("–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è:");
    if(amount>0){
        player.coins+=parseInt(amount);
        log(`üí∞ –í—ã –ø–æ–ø–æ–ª–Ω–∏–ª–∏ —Å—á–µ—Ç –Ω–∞ ${amount} –º–æ–Ω–µ—Ç`);
        player.vipLevel++;
        log(`‚ú® VIP —É—Ä–æ–≤–µ–Ω—å –ø–æ–≤—ã—à–µ–Ω! –¢–µ–∫—É—â–∏–π VIP —É—Ä–æ–≤–µ–Ω—å: ${player.vipLevel}`);
        if(firstDonation){
            firstDonation=false;
            const bonus = {name:"–≠–ø–∏—á–µ—Å–∫–∏–π –º–µ—á", img:"https://i.imgur.com/OY8o0jA.png", type:"weapon"};
            player.equipment.weapon = bonus;
            log("üéÅ –ë–æ–Ω—É—Å –∑–∞ –ø–µ—Ä–≤–æ–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ: –≠–ø–∏—á–µ—Å–∫–∏–π –º–µ—á!");
            updateInventory();
        }
    }
}

// –ö–æ–Ω—Ç—Ä–æ–ª —á–µ—Ä–µ–∑ —Å—Ç—Ä–µ–ª–∫–∏
document.addEventListener("keydown",e=>{
    if(e.key==="ArrowUp" && player.y>0) moveTo(player.x,player.y-1);
    if(e.key==="ArrowDown" && player.y<4) moveTo(player.x,player.y+1);
    if(e.key==="ArrowLeft" && player.x>0) moveTo(player.x-1,player.y);
    if(e.key==="ArrowRight" && player.x<4) moveTo(player.x+1,player.y);
});

// –°–ø–∞–≤–Ω –Ω–∞—á–∞–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
spawnMonster(0,0);
spawnMonster(4,4);
spawnMonster(1,3);
spawnShop(2,0);
</script>

</body>
</html>
